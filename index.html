<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Stream</title>
    <script src="https://ssl.p.jwpcdn.com/player/v/8.36.2/jwplayer.js"></script>
    <script>
        jwplayer.key = 'EN7MpaKagehNwodFmcDG3/k/QCMXIo8qyzO5Fi+Bxq0='; // Your JWPlayer key
    </script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #000;
            color: #fff;
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
            height: 100vh; /* Full height for the body */
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column; /* Stack player and button vertically */
        }

        /* Krishna color banners - expanded to full width and larger height */
        .banner {
            width: 100%;
            background-color: #1E90FF; /* Krishna's blue color */
            color: #FFD700; /* Krishna's golden color */
            padding: 40px 0; /* Increased padding to make the banner larger */
            font-size: 48px; /* Larger text size */
            font-weight: bold;
            text-align: center;
            position: absolute;
            z-index: 10;
            box-sizing: border-box;
        }

        .top-banner {
            top: 0;
            height: 15%; /* Adjust height to 15% of the video */
        }

        .bottom-banner {
            bottom: 0;
            height: 15%; /* Adjust height to 15% of the video */
        }

        #jwplayer-container-wrapper {
            position: relative;
            width: 100%;
            height: 100vh; /* Full height of the wrapper */
            max-width: 100%;
            max-height: 100vh;
            padding: 0;
            border: 5px solid yellow; /* Yellow border */
            border-radius: 8px; /* Rounded corners */
            background-color: #000; /* Black background */
            box-sizing: border-box;
            padding-top: 15%; /* To ensure space for top banner */
            padding-bottom: 15%; /* To ensure space for bottom banner */
        }

        #jwplayer-container {
            width: 100%;
            height: 100%;
            box-sizing: border-box;
        }

        /* Hide all player controls */
        .jw-controls {
            display: none !important;
        }

        /* Current Time Display */
        #current-time {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 5px 15px;
            border-radius: 5px;
            font-size: 18px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            z-index: 10;
        }
    </style>
</head>
<body>
    <!-- Krishna Color Banners - Larger -->
    <div class="banner top-banner">Krishna's Divine Stream</div>
    <div class="banner bottom-banner">Stream 24/7 - Watch Now</div>

    <div id="jwplayer-container-wrapper">
        <div id="jwplayer-container"></div> <!-- JWPlayer container inside the fixed box -->
        <div id="current-time" class="badge bg-success">00:00:00</div> <!-- Current time display -->
    </div>

    <script>
        const m3u8Url = 'https://pothabattulavinod.github.io/m/1.m3u8'; // Ensure this is a valid .m3u8 URL

        // Set a predefined start time (1:00 PM today)
        function getPredefinedStartTime() {
            const startTime = new Date();
            startTime.setHours(13, 0, 0, 0); // Set to 1:00 PM today
            return startTime;
        }

        // Function to load the JWPlayer stream
        function loadStream(url, startTimeOffset) {
            jwplayer("jwplayer-container").setup({
                file: url,
                width: "100%",
                height: "100%",
                autostart: true,
                controls: false,
                stretching: 'uniform',
                repeat: false,
                preloading: 'auto',
                fallback: true,
                events: {
                    onError: function(event) {
                        console.log("Error loading stream:", event);
                        alert("Failed to load the stream. Please try again later.");
                    }
                }
            });

            // Wait for the player to be initialized, then seek to the calculated time offset
            jwplayer().on('ready', function() {
                console.log("Player is ready.");
                jwplayer().seek(startTimeOffset); // Seek to the calculated start position
            });
        }

        // Sync the video to the predefined start time (1:00 PM)
        function syncWithStartTime() {
            const startTime = getPredefinedStartTime();
            const currentTime = new Date();
            const timeDifference = currentTime - startTime; // Time difference from the start time

            // If the current time is after the predefined start time, calculate the start time offset
            if (timeDifference >= 0) {
                const startTimeOffset = timeDifference / 1000; // Convert milliseconds to seconds
                console.log(`Current time is: ${currentTime}`);
                console.log(`Start time offset is: ${startTimeOffset} seconds`);
                loadStream(m3u8Url, startTimeOffset); // Start stream at the correct offset
            } else {
                // If it's before the predefined start time, wait until the start time
                const waitTime = Math.abs(timeDifference);
                console.log(`Waiting for ${Math.floor(waitTime / 1000)} seconds...`);
                setTimeout(() => {
                    const startTimeOffset = 0; // Start at the beginning of the stream
                    loadStream(m3u8Url, startTimeOffset);
                }, waitTime);
            }
        }

        // Update current time on the player every second
        function updateCurrentTime() {
            const currentTime = new Date();
            const hours = String(currentTime.getHours()).padStart(2, '0');
            const minutes = String(currentTime.getMinutes()).padStart(2, '0');
            const seconds = String(currentTime.getSeconds()).padStart(2, '0');
            const currentTimeString = `${hours}:${minutes}:${seconds}`; // Format as HH:MM:SS

            document.getElementById("current-time").textContent = currentTimeString; // Update current time
        }

        // Always synchronize the video to the predefined start time
        window.addEventListener('load', function() {
            // Store the sync start time in localStorage
            const currentSyncTime = new Date().getTime();
            localStorage.setItem('syncStartTime', currentSyncTime);
            syncWithStartTime();
            setInterval(updateCurrentTime, 1000); // Update current time every second
        });

        // Sync video when page is revisited or refreshed
        if (localStorage.getItem('syncStartTime')) {
            syncWithStartTime(); // Always sync to the stored start time
        }
    </script>
</body>
</html>
