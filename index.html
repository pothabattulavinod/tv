<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Stream</title>
    <script src="https://ssl.p.jwpcdn.com/player/v/8.36.2/jwplayer.js"></script>
    <script>
        jwplayer.key = 'EN7MpaKagehNwodFmcDG3/k/QCMXIo8qyzO5Fi+Bxq0='; // Your JWPlayer key
    </script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #000;
            color: #fff;
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
            height: 100vh; /* Full height for the body */
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column; /* Stack player and button vertically */
        }

        #jwplayer-container-wrapper {
            position: relative;
            width: 100%; /* Full width of the wrapper */
            height: 100vh; /* Full height of the wrapper */
            max-width: 100%;
            max-height: 100vh;
            padding: 0; /* Remove any padding */
            border: 5px solid yellow; /* Yellow border */
            border-radius: 8px; /* Rounded corners */
            background-color: #000; /* Black background */
            box-sizing: border-box; /* Ensure the border is within the element */
        }

        #jwplayer-container {
            width: 100%;
            height: 100%;
            box-sizing: border-box; /* Include border in the total size */
        }

        /* Header and Footer banners */
        .banner {
            position: absolute;
            left: 0;
            width: 100%;
            height: 50px; /* Size of the banner */
            background-color: #6c63ff; /* Krishna color */
            color: white;
            text-align: center;
            font-size: 20px;
            line-height: 50px;
            font-family: Arial, sans-serif;
            z-index: 999;
        }

        .banner-top {
            top: 0;
        }

        .banner-bottom {
            bottom: 0;
        }

        /* Hide all player controls */
        .jw-controls {
            display: none !important;
        }
    </style>
</head>
<body>
    <div id="jwplayer-container-wrapper">
        <div class="banner banner-top">Krishna Channel</div> <!-- Top Banner -->
        <div id="jwplayer-container"></div> <!-- JWPlayer container inside the fixed box -->
        <div class="banner banner-bottom">Krishna Channel</div> <!-- Bottom Banner -->
    </div>

    <script>
        const m3u8Url = 'https://s04.nm-cdn3.top/files/81770422/720p/720p.m3u8?in=11e627e85706227a14ac7be68aef67af::4defb98685c55042d8fcd9ba3db949fc::1736067046::ni'; // Ensure this is a valid .m3u8 URL

        // Set a predefined start time (2:00 PM today)
        function getPredefinedStartTime() {
            const startTime = new Date();
            startTime.setHours(14, 0, 0, 0); // Set to 2:00 PM today (14:00)
            return startTime;
        }

        // Function to load the JWPlayer stream
        function loadStream(url, startTimeOffset) {
            jwplayer("jwplayer-container").setup({
                file: url,
                width: "100%", /* Full width of the wrapper */
                height: "100%", /* Full height of the wrapper */
                autostart: true,
                controls: false, /* Disable all player controls */
                stretching: 'uniform', /* Maintain aspect ratio */
                repeat: false, /* Don't loop the video */
                preloading: 'auto', /* Enable video preloading */
            });

            // Wait for the player to be initialized, then seek to the calculated time offset
            jwplayer().on('ready', function() {
                console.log("Player is ready.");
                jwplayer().seek(startTimeOffset); // Seek to the calculated start position
            });
        }

        // Sync the video to the predefined start time (2:00 PM)
        function syncWithStartTime() {
            const startTime = getPredefinedStartTime();
            const currentTime = new Date();
            const timeDifference = currentTime - startTime; // Time difference from the start time

            // If the current time is after the predefined start time, calculate the start time offset
            if (timeDifference >= 0) {
                const startTimeOffset = timeDifference / 1000; // Convert milliseconds to seconds
                console.log(`Current time is: ${currentTime}`);
                console.log(`Start time offset is: ${startTimeOffset} seconds`);
                loadStream(m3u8Url, startTimeOffset); // Start stream at the correct offset
            } else {
                // If it's before the predefined start time, wait until the start time
                const waitTime = Math.abs(timeDifference);
                console.log(`Waiting for ${Math.floor(waitTime / 1000)} seconds...`);
                setTimeout(() => {
                    const startTimeOffset = 0; // Start at the beginning of the stream
                    loadStream(m3u8Url, startTimeOffset);
                }, waitTime);
            }
        }

        // Always synchronize the video to the predefined start time
        window.addEventListener('load', function() {
            // Store the sync start time in localStorage
            const currentSyncTime = new Date().getTime();
            localStorage.setItem('syncStartTime', currentSyncTime);
            syncWithStartTime();
        });

        // Sync video when page is revisited or refreshed
        if (localStorage.getItem('syncStartTime')) {
            syncWithStartTime(); // Always sync to the stored start time
        }
    </script>
</body>
</html>
